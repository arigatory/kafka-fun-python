# Проект Kafka Producer-Consumer

Этот проект демонстрирует работу Kafka-продюсера и двух типов потребителей (pull и push) с использованием библиотеки `confluent_kafka` в Python.

## Структура проекта

Проект состоит из трех основных Python-файлов:

1. `producer.py`: Реализует Kafka-продюсера.
2. `consumer_pull.py`: Реализует Kafka-потребителя, использующего модель pull.
3. `consumer_push.py`: Реализует Kafka-потребителя, эмулирующего модель push.

## Классы и их функции

### Класс Message (во всех файлах)

- Назначение: Сериализация и десериализация сообщений.
- Методы:
  - `__init__(self, content)`: Инициализирует сообщение с содержимым.
  - `to_json(self)`: Сериализует сообщение в JSON.
  - `from_json(cls, json_str)`: Десериализует JSON в объект Message.

### Продюсер (в producer.py)

- Создает Kafka-продюсера с определенными конфигурациями.
- Отправляет сообщения в Kafka-топик.
- Использует обратный вызов для подтверждения доставки сообщения.

### Pull-потребитель (в consumer_pull.py)

- Создает Kafka-потребителя, который вручную опрашивает сообщения.
- Вручную фиксирует смещения после обработки каждого сообщения.

### Push-потребитель (в consumer_push.py)

- Создает Kafka-потребителя, эмулирующего push-модель.
- Автоматически фиксирует смещения.

## Инструкции по настройке и запуску

1. Убедитесь, что у вас установлен Python 3.7+.

2. Установите необходимую библиотеку:

   ```
   pip install confluent-kafka
   ```

3. Убедитесь, что ваш Kafka-кластер работает и доступен по адресам `localhost:9094`, `localhost:9095` и `localhost:9096`.

4. Запустите продюсера:

   ```
   python producer.py
   ```

5. В отдельных окнах терминала запустите потребителей:
   ```
   python consumer_pull.py
   python consumer_push.py
   ```

## Шаги проверки

1. Сначала запустите обоих потребителей.

2. Запустите продюсера. Вы должны увидеть вывод, указывающий на отправку сообщений.

3. Проверьте терминалы потребителей. Вы должны увидеть, что оба потребителя получают сообщения.

4. Убедитесь, что:

   - Pull-потребитель вручную фиксирует смещения после каждого сообщения.
   - Push-потребитель автоматически фиксирует смещения.
   - Оба потребителя получают одинаковые сообщения.

5. Если вы остановите и перезапустите потребителя, он должен продолжить с того места, где остановился, благодаря зафиксированным смещениям.

6. Продюсер должен повторять попытки отправки сообщений при временном сбое (вы можете симулировать это, временно остановив брокер Kafka).

## Принципы работы

- Продюсер отправляет сообщения в Kafka-топик с гарантией доставки "как минимум один раз".
- Pull-потребитель вручную получает сообщения и фиксирует смещения, обеспечивая больший контроль над обработкой сообщений.
- Push-потребитель эмулирует push-модель путем непрерывного опроса сообщений, обеспечивая более "реальное" ощущение.
- Оба потребителя используют `fetch.min.bytes` для обеспечения получения минимального объема данных за запрос, что может помочь в симуляции различий между моделями pull и push.

Следуя этим шагам и понимая принципы, вы можете проверить, что приложение работает в соответствии с требованиями задания.
